      FUNCTION MULTAIC2(WORK,NCHANS,IRECL,MAXAR,Q,V,
     $                  R2,R1M,RCONST,IPIV,ITRMX,IALG)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      INTEGER RYSAIC
      REAL DANE
      DIMENSION WORK(NCHANS,IRECL)
      DIMENSION R2(NCHANS*MAXAR,NCHANS*MAXAR)
      DIMENSION R1M(NCHANS*MAXAR,NCHANS)
      DIMENSION V(NCHANS,NCHANS)
      DIMENSION RCONST(NCHANS,NCHANS,MAXAR+1)
      DIMENSION IPIV(NCHANS*MAXAR)
      DIMENSION Q(NCHANS*MAXAR,NCHANS)
      DIMENSION CRIT(:)
      ALLOCATABLE CRIT
      COMMON /DEV/ITI 
      COMMON /ARERR/ IERR
                                     
      IF(IERR.NE.0)RETURN
      ALLOCATE(CRIT(MAXAR+1),STAT=IERR)
      IF(IERR.NE.0)THEN
        IERR=1
        GOTO 20
      ENDIF
      
      Do 1,IORD=MAXAR,1,-1	
	CALL CCORR(WORK,R2,R1M,V,RCONST,NCHANS,IRECL,IORD,IALG)
	
!      write(3929,*)IORD
!      do 3929,i3929=1,NCHANS
!      write(3929,*)(V(i3929,j3929),j3929=1,NCHANS)
!3929  write(3929,*)' '      
	
	CALL SOLVEARYWCOV(R2,Q,R1M,V,NCHANS,IORD,IPIV,IALG)
	
!      write(3928,*)IORD
!      do 3928,i3928=1,NCHANS
!      write(3928,*)(V(i3928,j3928),j3928=1,NCHANS)
!3928  write(3928,*)' '      
	
	
	CALL DPOTRF('U',NCHANS,V,NCHANS,INFO)
	if(info.ne.0)then
	  WRITE(ITI,*)'MULTAIC ERROR'
	  IERR=1
	  GOTO 30
	ENDIF
	DT=V(1,1)
	Do 2,I=2,NCHANS
2     DT=DT*V(I,I)
      DT=DT*DT
1	CRIT(IORD+1)=DLOG(DT)*DBLE(ITRMX)/DBLE(NCHANS)
     $             +2D0*DBLE(NCHANS)*DBLE(IORD)/DBLE(IRECL)
      CRIT(1)=CRIT(2)

      MULTAIC2=RYSAIC(CRIT,MAXAR+1)
      
30    CONTINUE
10    DEALLOCATE(CRIT)
20    RETURN
      END      