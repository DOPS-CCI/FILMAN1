!DEC$ FREEFORM 
! SKPLST.FOR- BYPASSES A LIST OF RECORD-SETS

	SUBROUTINE SKPLST
    
	CHARACTER*1 ITBL(12)
	COMMON IFLAG1,IFLAG2,IFLAG3,KNT
	COMMON/DEV/ITI
	COMMON/FLDES/ NG,NA,NC,ND,NF,NL,NR
	INTEGER*4, SAVE :: J,NN,IN
	CHARACTER*1, SAVE :: LIST(240)
	DATA ITBL/'0','1','2','3','4','5','6','7','8','9','-',','/
      INTEGER SELGRPS(20)
	CHARACTER*24 LINESEL(20)
	CHARACTER*2048 LINELONG
      COMMON /SELGVS/ SELGRPS,LINESEL,LINELONG

	IF(IFLAG1) 10,20,30
10    NSET=NR/NC
      DO 102 I=1,MIN(LEN_TRIM(LINELONG),2048)
102       LIST(I)=LINELONG(I:I)
	J=0
	NN=0
30    RETURN

20    IF(NN.LE.0) GO TO 21
22    IF(KNT.LT.IN) RETURN
      NN=NN-1
	IFLAG2=0
	RETURN
21    IF(J.LT.0) RETURN
25    IN=-1
1     NN=0
2     J=J+1
	IF(J.GT.240) GO TO 8
12    DO 3 I=1,12
          IF(ITBL(I).EQ.LIST(J)) GO TO 4
3     CONTINUE
	GO TO 2
4     GO TO(5,5,5,5,5,5,5,5,5,5,7,6),I
5     NN=NN*10+I-1
	GO TO 2
7     IN=NN
	GO TO 1
8     J=-1
6     IF(IN.GE.0) GO TO 11
9     IN=NN
	NN=1
	GO TO 22
11    NN=NN-IN+1
	GO TO 22
	END

