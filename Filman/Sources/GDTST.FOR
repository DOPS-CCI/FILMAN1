C GDTST.FOR- SUBROUTINES FOR GOOD'S SERIAL RANDOMNESS TEST

C SUBROUTINE TO TRUNCATE OVERSIZE REQUESTS

	SUBROUTINE IR(NMAX,IT,IV)
	
	CHARACTER*128 LINE

	K=1

	KT=0

	DO 10 I=1,IV

	K=K*IT

	KT=KT+K

	IF(NMAX-KT)5,10,10

5       IV=I-1

!	WRITE(*,200)IV

200     FORMAT(' OVERSIZED REQUEST; # ORDERS REDUCED TO ',I1)
	WRITE(LINE,200)IV
      Call ShowInfoText('Warning',LINE)

	RETURN

10      CONTINUE

	RETURN

	END

C       ACCUMULATES TOTALS

	SUBROUTINE GDTST1(INEW)

	DIMENSION I(16)

	COMMON/GOOD/ANTOT,IT,IVMAX,N(1)

	IF(ANTOT) 1,1,2

1       ANTOT=0.0

	DO 3 K=1,IVMAX

3       I(K)=0

2       IOFF=1

	IT1=1

	ANTOT=ANTOT+1.0

	DO 4 K=1,IVMAX

	J=INEW*IT1+I(K)/IT

	I(K)=J

	IF(ANTOT-K) 5,6,6

6       J=J+IOFF

	N(J)=N(J)+1

5       IT1=IT1*IT

4       IOFF=IOFF+IT1

	RETURN

	END

C       CALCULATES STAT/DF



	SUBROUTINE GDTST2(D2PSI,IDF)

	DIMENSION D2PSI(1),IDF(1)

	COMMON/GOOD/ANTOT,IT,IVMAX,N(1)

	I=1

	IT1=1

	DO 1 K=1,IVMAX

	IT1=IT1*IT

	P=(ANTOT-K+1)/FLOAT(IT1)

	X=0.

	DO 2 J=1,IT1

	X=X+(N(I)-P)**2

2       I=I+1

	IDF(K)=IT1

1       D2PSI(K)=X/P

	I=IVMAX

6       IF(I-2) 3,4,5

5       D2PSI(I)=D2PSI(I)-2.*D2PSI(I-1)+D2PSI(I-2)

	IDF(I)=IDF(I)-2*IDF(I-1)+IDF(I-2)

	I=I-1

	GO TO 6

4       D2PSI(2)=D2PSI(2)-2.*D2PSI(1)

	IDF(2)=IDF(2)-2*IDF(1)+1

3       IDF(1)=IT-1

	RETURN

	END

C       PRINTS OUT TOTALS

	SUBROUTINE GDTST3(IV)

	DIMENSION KI(8)

	COMMON/GOOD/ANTOT,IT,IVMAX,N(1)

!	COMMON/DEV/ITI,IOX
	COMMON/DEV/ ITI,ILP,IGRAPH,IOX

	J=1

	IT1=IT

	DO 1 I=1,IV

	WRITE(IOX,300)I

300     FORMAT(/'  ORDER',I3)

	DO 2 K=1,IT1

	M=K-1

	DO 3 L=1,I

	KI(L)=MOD(M,IT)+1

3       M=M/IT

	WRITE(IOX,100) (KI(L),L=1,I)

	WRITE(IOX,200) N(J)

2       J=J+1

1       IT1=IT1*IT

100     FORMAT(1H ,8I3)

200     FORMAT(1H+,T26,I7)

	RETURN

	END



