      SUBROUTINE STARTCMM(NUMSCRS,TITLES)
	USE IFQWIN
	COMMON/DEV/ITI,ILP,IGRAPH
	COMMON /ADVPL/ AON,NUMA,IMAXX,IMAXY
	LOGICAL AON
	CHARACTER*(*) TITLES(NUMSCRS)
	RECORD/QWINFO/ WINFO
	save WINFO
	DATA AON /.FALSE./
      integer IGRAPHHWND
      COMMON /IGHWND/ IGRAPHHWND,ISX,ISY
      integer*2 ISX,ISY
	INTEGER WINVER
	type(windowconfig) :: wco

      NUMA=NUMSCRS
      AON=.FALSE.  
      DO 1,IW=IGRAPH+1,IGRAPH+NUMSCRS      
        OPEN(UNIT=IW,FILE='USER',TITLE=TITLES(IW-IGRAPH))
        IRES=INITIALIZEFONTS()
        ISTAT = SETFONT("t'Arial'h10w5")
	  IRES=SETBKCOLORRGB(Z'00FFFFFF')
	  IRES=SETCOLORRGB(0)
	  IRES=SETTEXTCOLORRGB(0)
	  WINFO%TYPE=QWIN$MAX
	  IRES=SETWSIZEQQ(IW,WINFO)
        IF(WINVER().GE.7)THEN
            igraphHwnd=GetHwndQQ(IGRAPH+1)
            CALL MGetWindowSize(igraphHwnd,IW1,IH1)
            Imaxx=IW1-32
            Imaxy=IH1-64
        ELSE
            Ltemp=GETWINDOWCONFIG(wco)
            Imaxx=wco%numxpixels
            Imaxy=wco%numypixels
        ENDIF
!	  IRES=GETWSIZEQQ(IW,QWIN$SIZEMAX,WINFO)
!	  Imaxx=9*winfo%w
!	  Imaxy=18*winfo%h
	  call clearscreen(0)
	  IRES=SETWRITEMODE($GPSET)
	  isx=imaxx
	  isy=imaxy
1     CONTINUE    
      AON=.TRUE.  
      RETURN
      END
      
	SUBROUTINE INITGRAPH(MAXX,MAXY,NTR,NTC,NBBP,NCOLOR)
	COMMON /ADVPL/ AON,NUMA,IMAXX,IMAXY
	LOGICAL AON
	INTEGER*2 MAXX,MAXY
      integer IGRAPHHWND
      COMMON /IGHWND/ IGRAPHHWND,ISX,ISY
      integer*2 ISX,ISY
	IF(AON)THEN
	  MAXX=IMAXX
	  MAXY=IMAXY
	  isx=maxx
	  isy=maxy
	ELSE
	  CALL GRAPHMODE_ON(MAXX,MAXY,NTR,NTC,NBBP,NCOLOR,0)
	ENDIF
	RETURN
      END
      
	SUBROUTINE SETGSCR(IK)
	COMMON /ADVPL/ AON,NUMA
	LOGICAL AON
	COMMON/DEV/ITI,ILP,IGRAPH
	IF(AON)IRES=FOCUSQQ(IGRAPH+IK)
	RETURN
      END
      
      SUBROUTINE CLOSEGRAPH
	COMMON /ADVPL/ AON,NUMA
	LOGICAL AON
	IF(.NOT.AON)CALL GRAPHMODE_OFF
      RETURN
      END
      
      SUBROUTINE STOPCMM
	COMMON/DEV/ITI,ILP,IGRAPH
	COMMON /ADVPL/ AON,NUMA
	LOGICAL AON
	IRES=FOCUSQQ(5)
      AON=.FALSE.  
	DO 1,IW=IGRAPH+NUMA,IGRAPH+1,-1
1     CLOSE(IW)	
      RETURN
      END
      
	SUBROUTINE CMCLS
	USE IFQWIN
	COMMON /ADVPL/ AON,NUMA
	LOGICAL AON
	COMMON/DEV/ITI,ILP,IGRAPH
	IF(AON)THEN
	  DO 1,IW=IGRAPH+1,IGRAPH+NUMA
	  IRES=FOCUSQQ(IW)
C	  CALL CLEARSCREEN(0)
	  CALL CLEARSCREEN($GCLEARSCREEN)
1       CONTINUE
      ENDIF	  
	RETURN
      END
      
      