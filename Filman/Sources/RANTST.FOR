C RANTST.FOR- ROUTINE TO APPLY GOOD'S GENERALIZED SERIAL TEST

C TO FORTRAN SUBROUTINES RANDOM

	DIMENSION D2PSI(9),IDF(9)

	COMMON/GOOD/ANTOT,IT,IVMAX,N(6000)

	COMMON /DEV/ITI,IOX

	ITI=5

	IOX=7

	NFN=6000

	OPEN(UNIT=IOX,FILE='LPT1')

	WRITE(IOX,200)

200   FORMAT('1GENERALIZED SERIAL TEST FOR SUBROUTINE RANDOM')

3     WRITE(ITI,104)

104   FORMAT('$# CATEGORIES? MAX ORDER? >'\)

	READ(ITI,*) IT,IVMAX

6     ANTOT=0.0

	XN=FLOAT(IT)

	CALL GETTIM(I1,I2,I3,I4)

	ISEED=I1*I2+I3*I4

	CALL SEED(ISEED)

12    WRITE(ITI,101)

101   FORMAT('$TRIALS: # TRIALS/RND? # RNDS? >'\)

	READ(ITI,*)NTOT1,NRND

	NTOT=0

	NEW=1

	DO 8 I=1,IVMAX

	NEW=NEW*IT

8     NTOT=NTOT+NEW

	IF(NTOT-NFN)9,9,11

11    WRITE(ITI,203)NTOT,NFN

203   FORMAT(' COUNTERS REQUESTED=',I5,'; AVAILABLE=',I4)

	GO TO 12

9     DO 1 I=1,NFN

1     N(I)=0

	WRITE(IOX,107) IT,NTOT1,NRND

107   FORMAT(/' # CATS =',I2,', TRIALS/RND=',I4,', # RNDS=',I3)

	DO 2 K=1,NRND

	DO 2 I=1,NTOT1

	CALL RANDOM(YFL)

	J=IFIX(XN*YFL)

	IF(J.EQ.IT)J=IT-1

2     CALL GDTST1(J)

	CALL GDTST2(D2PSI,IDF)

	WRITE(IOX,300)

300   FORMAT(//' OVERALL RESULTS:'/4X,'ORDER',11X,'CHISQUARE',5X,'DF')

	WRITE(IOX,100) (I,D2PSI(I),IDF(I),I=1,IVMAX)

100   FORMAT(6XI3,E20.5,I8)

	WRITE(ITI,105)

105   FORMAT('$# OF ORDERS TO LIST? >'\)

	READ(ITI,*) IV

	IF(IV) 7,7,4

4     WRITE(IOX,400)

400   FORMAT(//' INDIVIDUAL TOTALS BY ORDER:')

	CALL GDTST3(IV)

7     WRITE(ITI,108)ANTOT

108   FORMAT(' NUMBER OF TRIALS=',F10.0)

	WRITE(ITI,109)

109   FORMAT('$WANT ANOTHER RUN? >'\)

	READ(ITI,110)IFLAG

110   FORMAT(A)

	IF(IFLAG.EQ.'Y')GO TO 3

5     WRITE(IOX,500)

500   FORMAT(//' END OF JOB'/1H1)

	CLOSE(IOX)

	STOP

	END



