C GRPRNT.FOR- PRINTS VALUES OF UP TO 15 GROUP VARS

	SUBROUTINE GRPRNT

      INCLUDE 'MAX.INC'

	CHARACTER*2 INSPEC(32)

	COMMON IFLAG1,IFLAG2,IFLAG3,KNT,ISZ

	COMMON/DEV/ITI,ILP,IGRAPH,IXO

	COMMON/FLDES/ NG,NA,NC,ND,NF,NL,NR,NSR,IBUF(IOMAX)

	COMMON /FLDESO/NGO,NAO,NCO,NDO,NFO,NPO,NRO,ISO,IBUFO(IOMAX)

	COMMON/STDFIL/INSPEC

	INTEGER*4, SAVE :: K,IC

	DIMENSION LINE(15)

	DATA LINE /8*' -',7*'--'/
      COMMON /CPN/ CURPROCNAME
      CHARACTER*10 CURPROCNAME
      CHARACTER*1024 OUTNAME
      CHARACTER*1024 OUTFNM
      CHARACTER*24 NSLABL

	IF(IFLAG1) 10,20,30

10    IFLAG3=0
      CURPROCNAME='GRPRNT'

	ISZ=0

	IC=NG-1

	IF(IC-15) 40,40,50

50    IC=15

40    OUTNAME=OUTFNM(CURPROCNAME)
      OPEN(UNIT=IXO,FILE=OUTNAME,ACTION='WRITE',STATUS='REPLACE')

!	WRITE(IXO,99)(INSPEC(I),I=1,32)
!
!99    FORMAT('GRPRNT OF ',32A2)
!
!	WRITE(IXO,100)(IBUFO(I),I=1,108)
!
!100   FORMAT(18A4)

	K=7

      WRITE(IXO,'(A\)')'TRIAL#'
	DO 15 I=1,IC

	L=K+5

!	WRITE(IXO,101)I+1,(IBUF(J),J=K,L)
      CALL ScanAndRemoveSpaces(IBUF(K),L-K+1,NSLABL)
      WRITE(IXO,1011)TRIM(NSLABL)

101   FORMAT('GROUP VAR ',I2,' ID=',6A4)
1011  FORMAT(1X,A\)

15    K=K+6
      WRITE(IXO,*)

!	WRITE(IXO,102)(I+1,I=1,IC)
!
!102   FORMAT(/1H ,4X,15(3XI2))
!
!	WRITE(IXO,103)(LINE(I),I=1,IC)
!
!103   FORMAT(1H ,4X,15(3XA2)/)

	K=0

	RETURN

	

20    IF(K-KNT)25,38,38

25    K=KNT

	WRITE(IXO,200) KNT,(IBUF(I+1),I=1,IC)

200   FORMAT(1XI4,15I5)

	RETURN

30    CLOSE(IXO)

38    RETURN

	END

