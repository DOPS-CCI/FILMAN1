C KEYSEL.FOR- SELECTS RECORD-SETS ON GROUP VARS

	SUBROUTINE KEYSEL

	DIMENSION LAB(6,20)

	COMMON IFLAG1,IFLAG2

	COMMON/DEV/ITI

	COMMON/FLDES/ NG,NA,NC,ND,NF,NL,NR,IS,IBUF(120)

	INTEGER*4, SAVE :: IG(10),N(10,10),ICNT

	EQUIVALENCE (LAB(1,1),IBUF(1))

	DATA ILP,IRP/'(',')'/
	
      INTEGER SELGRPS(20)
      CHARACTER*24 SELVALS(20)
      COMMON /SELGVS/ SELGRPS,SELVALS

	IF(IFLAG1) 10,20,20

10    ICNT=0

	IF(NG-1) 11,11,12

12    CONTINUE
!12    WRITE(*,100) (J,(LAB(I,J),I=1,6),J=2,NG)
!
!100   FORMAT(' GROUP ',I2,' ID=',6A4)
!
!	WRITE(*,101)(ILP,IRP,I=1,MIN(10,NG-1))
!
!101   FORMAT(' WHICH GROUPS?'/1H$,10(A1,2XA1,:))
!
!	READ(*,102) (IG(I),I=1,10)
      IG=SELGRPS(1:10)

102   FORMAT(10(1X,I2,1X))

	DO 13 I=1,10

	IF(IG(I)-1) 13,13,14

14    ICNT=ICNT+1

	IG(ICNT)=IG(I)

!	WRITE(*,103) IG(ICNT),(ILP,IRP,J=1,10)
!
!103   FORMAT(' SELECTION VALUES FOR GROUP ',I2/1H$,10(A1,2XA1))
!
!	READ(*,102) (N(ICNT,J),J=1,10)
      READ(SELVALS(ICNT),*,end=13) (N(ICNT,J),J=1,10)

13    CONTINUE

11    RETURN

20    IF(ICNT) 21,21,22

22    DO 23 I=1,ICNT

	K=IBUF(IG(I))

	DO 24 J=1,10

	IF(N(I,J)-K) 24,23,24

24    CONTINUE

	IFLAG2=0

	GO TO 21

23    CONTINUE

21    RETURN

	END
