C PRONYTST.FOR- ATTEMPT TO REPRODUCE MARPLE;S RESULTS, P.347

      DIMENSION FREQ(16),DAMP(16),AMP(16),PHASE(16)

      COMPLEX X(64),H(16),Z(16)

      OPEN(UNIT=7,FILE='LPT1',MODE='WRITE')

      T=1.

      CALL TESTDATA(X)

C EXAMPLE 1

      K=1

      IP=15

      CALL PRONY(1,64,IP,X,H,Z,ISTAT)

      CALL EXPARAMS(IP,T,H,Z,AMP,DAMP,FREQ,PHASE)

      ASSIGN 15 TO LOC

5     WRITE(7,101)K,ISTAT

101   FORMAT(/' PROBLEM',I2,' RETURNED FROM PRONY WITH ISTAT=',I1)

      DO 10 I=1,IP

      WRITE(7,100)FREQ(I),DAMP(I),AMP(I),PHASE(I)

100   FORMAT(5X,4F12.5)

10    CONTINUE

      PAUSE ' <CR> FOR NEXT PROBLEM'

      GO TO LOC

C EXAMPLE 2

15    IP=16

      K=2

      ASSIGN 30 TO LOC

      CALL TESTDATA(X)

      CALL PRONY(2,64,IP,X,H,Z,ISTAT)

      CALL EXPARAMS(IP,T,H,Z,AMP,DAMP,FREQ,PHASE)

      GO TO 5

30    CLOSE(UNIT=7)

      STOP

      END

