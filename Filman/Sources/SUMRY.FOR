C SUMRY.FOR- WRITES STANDARD-FILE SUMMARY FROM HEADER INFO TO ITI/LP

C MODIFIED 3/95 TO ACCOMMODATE BIG RECORDS AND PRINT CHANNEL LABELS

C IN COMPRESSED FORMAT

      INCLUDE 'MAX.INC'

	CHARACTER*1 INFIL(64),IY,IY0,IA

	INTEGER*2 I2

	DIMENSION LABEL(6,50),IHDR1(116)

	COMMON/FLDES/ NG,NA,NC,ND,NF,NL,NR,IS,IBUF(IOMAX)

	COMMON/STDFIL/INFIL

	EQUIVALENCE (IHDR1(1),NG),(IBUF(1),LABEL(1,1))

	DATA IY,IY0/'Y','y'/

10    CALL GETOPN

13    CALL GETSTD(IHDR1)

	WRITE(*,997)(INFIL(I),I=1,64)

997   FORMAT(//' SUMMARY OF CONTENTS OF STANDARD FILE ',64A1)

	WRITE(*,1001) (IBUF(I),I=1,108)

1001  FORMAT(1X,18A4)

	WRITE(*,1002) NG

1002  FORMAT(' NUMBER OF GROUP VARIABLES=',I2)

	WRITE(*,1003) NA

1003  FORMAT(' NUMBER OF ANCILLARY WORDS=',I3)

	WRITE(*,1004) NC

1004  FORMAT(' NUMBER OF CHANNELS=',I3)

	GO TO (1,2,3,4)NF

1     WRITE(*,1008)

1008  FORMAT(' DATA FORMAT IS INTEGER*4')

	GO TO 45

2     WRITE(*,1009)

1009  FORMAT(' DATA FORMAT IS INTEGER*2  (PACKED)')

	GO TO 45

3     WRITE(*,1010)

1010  FORMAT(' DATA FORMAT IS REAL*4')

	GO TO 45

4     WRITE(*,1014)

1014  FORMAT(' DATA FORMAT IS COMPLEX (RE*4,IM*4)')

45    WRITE(*,1005) ND

1005  FORMAT(' NUMBER OF DATA POINTS=',I6)

	WRITE(*,1015)NL

1015  FORMAT(' NUMBER OF DOUBLE-WORDS PER DATA RECORD=',I6)

	WRITE(*,1006) IS

1006  FORMAT(' SAMPLING RATE OR FREQUENCY CUTOFF=',I6)

	WRITE(*,1007) NR

1007  FORMAT(' TOTAL NUMBER OF RECORDS=',I8)

	K=NR/NC

	WRITE(*,1013) K

1013  FORMAT(' NUMBER OF RECORD-SETS=',I5)

	CALL GETSTD(IBUF)

	K=NG+NC

	IF(NG) 7,7,8

8     DO 5 I=1,NG

5     WRITE(*,1011) I,(LABEL(J,I),J=1,6)

1011  FORMAT(' GROUP VARIABLE ',I2,' ID=',6A4)

c print channel labels using filman code      

7     WRITE(*,1020)

1020  FORMAT(' INPUT CHANNELS:')

	N=6*NG+1

	DO 6 I=1,NC,3

	K2=NC-I

	WRITE(*,200)(I+K,(IBUF(J),J=N+6*K,N+6*K+4),K=0,MIN(K2,2))

200   FORMAT(1H ,3(I3,'=',5A4,'     '))

6     N=N+18

	CALL GETEND

	WRITE(*,2000)

2000  FORMAT('$ANOTHER SUMRY? >'\)

	READ(*,2001)IA

2001  FORMAT(A1)

	IF(IA.EQ.IY .OR. IA.EQ.IY0) GO TO 10

	STOP   

	END



