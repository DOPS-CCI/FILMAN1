C RECLST.FOR- SELECTS A LIST OF RECORD-SETS INPUT FROM TERMINAL

	SUBROUTINE RECLST

	CHARACTER*1 ITBL(12)

	COMMON IFLAG1,IFLAG2,IFLAG3,KNT

	COMMON/DEV/ITI

	COMMON/FLDES/ NG,NA,NC,ND,NF,NL,NR

	INTEGER*4, SAVE :: J,NN,IN

	CHARACTER*1, SAVE :: LIST(2048)

	DATA ITBL/'0','1','2','3','4','5','6','7','8','9','-',','/
	
      INTEGER SELGRPS(20)
	CHARACTER*24 LINESEL(20)
	CHARACTER*2048 LINELONG
      COMMON /SELGVS/ SELGRPS,LINESEL,LINELONG

	IF(IFLAG1) 10,20,30

10    NSET=NR/NC

!	WRITE(*,100)NSET
!
!100   FORMAT(' INSERT LIST(3 LINES); INPUT FILE HAS',I5,' RECSETS')
!
!C	READ(*,101) (LIST(I),I=1,240)
!      CALL GETVALU(2,IVAL,ALINE,'(A)')
!      WRITE(*,'(A)')ALINE
!      READ(ALINE,'(240A1)') (LIST(I),I=1,240)
!
!101   FORMAT(80A1)
      DO 102,I=1,MIN(LEN_TRIM(LINELONG),2048)
102   LIST(I)=LINELONG(I:I)

	J=0

	NN=0

30    RETURN

20    IF(NN) 21,21,22

22    IF(KNT-IN) 23,24,24

23    IFLAG2=0

	GO TO 30

24    NN=NN-1

	GO TO 30

21    IF(J) 26,25,25

26    KNT=-1

	GO TO 23

25    IN=-1

1     NN=0

2     J=J+1

	IF(J-240) 12,12,8

12    DO 3 I=1,12

	IF(ITBL(I).EQ.LIST(J)) GO TO 4

3     CONTINUE

	GO TO 2 !Unknown character/blank

4     GO TO(5,5,5,5,5,5,5,5,5,5,7,6),I

5     NN=NN*10+I-1

	GO TO 2

7     IN=NN

	GO TO 1

8     J=-1

6     IF(IN) 9,11,11

9     IN=NN

	NN=1

	GO TO 22

11    NN=NN-IN+1

	GO TO 22

	END

