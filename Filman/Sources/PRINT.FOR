C PRINT.FOR- PRINT SELECTED DATA POINTS FROM A FILMAN FILE

	SUBROUTINE PRINT

      INCLUDE 'MAX.INC'

	CHARACTER*1 INPFIL(64)

	DIMENSION X(6)

	COMMON IFLAG1,IFLAG2,IFLAG3,KNT,ISZ,ICHAN(ICHMAX)

	COMMON/STDFIL/INPFIL

	COMMON/FLDES/ NG,NA,NC,ND,NF,NL,NR,NSR,IBUF(IOMAX)

	COMMON/FLDESO/ NGO,NAO,NCO,NDO,NFO,NLO,NRO,ISO,IBUFO(IOMAX)

!	COMMON/DEV/ITI,IXO
	COMMON/DEV/ ITI,ILP,IGRAPH,IXO

	INTEGER*4, SAVE :: IC,NGF,IT,LAB(6,ICHMAX)

	EQUIVALENCE (IBUFO(1),ICH)
      COMMON /CPN/ CURPROCNAME
      CHARACTER*10 CURPROCNAME
      CHARACTER*1024 OUTNAME
      CHARACTER*1024 OUTFNM

	IF(IFLAG1) 10,20,30

10      IFLAG3=0
      CURPROCNAME='PRINT'
      WRITE(*,*) CURPROCNAME
	NGF=0

      OUTNAME=OUTFNM(CURPROCNAME)
	OPEN(UNIT=IXO,FILE=OUTNAME,ACTION='WRITE',STATUS='REPLACE')

	WRITE(IXO,99)(INPFIL(I),I=1,64)

99      FORMAT(' FILMAN PRINTING FROM ',64A1)

	WRITE(IXO,100)(IBUFO(I),I=1,108)

100     FORMAT(1H ,18A4)

	IF(NG-2)16,16,17

17      K=13

	NGF=1

	DO 15 I=3,NG

	K1=K+5

	WRITE(IXO,101)I,(IBUF(J),J=K,K1)

 101    FORMAT(' GROUP VAR ',I2,' ID=',6A4)

 15     K=K+6

16    CONTINUE  
!      WRITE(*,102)
!
! 102    FORMAT('$DATA XFORM:0=NONE/1=SQRT/2=LN/3=ARCSIN/4=ABS >'\)
!
!	READ(*,103)IT
!
! 103    FORMAT(I1)
      CALL DoPRINTDialog(IT)

	IT=IT+1

	DO 40 I=1,NCO

	K=6*(NG+ICHAN(I))-5

	DO 40 J=1,6

	LAB(J,I)=IBUF(K)

40      K=K+1

	ISZ=0

	IC=0

	RETURN

C EXECUTION PHASE

20      WRITE(IXO,200) KNT,ICHAN(ICH),(LAB(I,ICH),I=1,6)

200     FORMAT(//' RECORD-SET ',I4,'; CHANNEL ',I2,': ',6A4)

	IC=IC+1

	IF(IC-1)25,25,23

25      IF(NGF)45,45,41

41      WRITE(IXO,201)(I,I=3,NG)

	WRITE(IXO,204)(IBUF(I),I=3,NG)

201     FORMAT(' GROUP VARS:'/' GROUP #',12(4XI2))

204     FORMAT('  VALUE ',12(1XI5))

45      IF(NA)23,23,22

22      K1=NG+1

	K2=NG+NA

	WRITE(IXO,202)(IBUF(K),K=K1,K2)

202     FORMAT(' ANCILLARY WORDS:'/(' ',18Z4))

23      DO 21 K=1,NDO,6

	L=MIN0(K+5,NDO)

	J=0

	DO 26 I=K,L

	J=J+1

	    CALL XVAL(I,XV,XI)

26      X(J)=RECODE(XV,IT)

21      WRITE(IXO,203) K,(X(I),I=1,J)

203     FORMAT(1H ,I4,1X,1P,6(E12.4))

	IF(IC-NCO)29,28,29

28      IC=0

29      RETURN

30      WRITE(IXO,301)

301     FORMAT(//' END OF PRINT OUTPUT')

	CLOSE(UNIT=IXO)

	RETURN

	END

